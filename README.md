# AI-Powered Cybersecurity for Internet of Medical Things (IoMT) Devices

## ğŸš€ Project Overview

With the rapid integration of Internet of Medical Things (IoMT) devices into Moroccan healthcare systems, hospitals are achieving unprecedented operational efficiency. However, this progress also exposes critical vulnerabilities in cybersecurity, especially in safeguarding sensitive patient data and maintaining system availability. Recent cyberattacks targeting Moroccan institutions highlight the urgent need for robust, locally developed solutions tailored to the nation's specific challenges.

In response to this critical issue, and within the framework of the MDFDS Hackathon on "AI for Healthcare," we propose an AI-driven cybersecurity solution designed specifically for IoMT networks. Our system uses Artificial Intelligence to continuously analyze network logs generated by IoMT devices, enabling the early detection and prediction of potential cyber threats before they disrupt healthcare services.

Our approach combines intelligent feature extraction from raw network data with state-of-the-art machine learning modelsâ€”including boosting, bagging, and probabilistic classifiersâ€”while ensuring lightweight architecture for fast inference and easy integration into hospital systems. After rigorous preprocessing and training phases, our best model (GradientBoostingClassifier) achieved outstanding results on unseen data:
- **Accuracy**: 99.46%
- **Precision**: 99.99%
- **Recall**: 99.33%
- **F1 Score**: 99.66%
- **AUC**: 99.97%
- **Sampling**:	Under
- **PCA**: Without PCA

This solution empowers Moroccan healthcare institutions to proactively secure their IoMT ecosystems, protect patient confidentiality, comply with national cybersecurity regulations, and ensure safer, smarter healthcare services for the future.

---

## ğŸ› ï¸ Setup & Usage Instructions

1. **Clone the repository**:
   ```bash
   git clone https://github.com/mohamed-stifi/MDFDS-Hackathon-CNSS-team.git
   cd MDFDS-Hackathon-CNSS-team
   ```

2. **Install the required dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

3. **Run the Notebooks**:
   - Start exploring the data: `data_discover.ipynb`
   - Analyze log patterns: `Log_information_analysis.ipynb`
   - Analyze the results: `results_analysis.ipynb`
   - Apply preprocessing and model training:
     - `oversampling_data_preprocessing.ipynb` (using oversampling)
     - `undersampling_data_preprocessing.ipynb` (using undersampling)

4. **Model Usage**:
   - Use the best pre-trained model `best_classifier.pkl` for real-time predictions.

---

## ğŸ¯ How to Find Key Information Quickly

- **Understand Dataset** â” Start with `data_discover.ipynb`
- **Log Analysis & Feature Building** â” See `Log_information_analysis.ipynb` + `featuer_extraction.py`
- **Model Training & Results** â” Check `oversampling_data_preprocessing.ipynb` and `undersampling_data_preprocessing.ipynb`
- **Use Final Model** â” Load `best_classifier.pkl` directly for predictions
- **Discover The Metrics Results** â” Check  `results_analysis.ipynb` + `oversampling_data_preprocessing.ipynb` and `undersampling_data_preprocessing.ipynb`

---

## ğŸ§© Project Structure

```plaintext
â”œâ”€â”€ best_classifier.pkl 
â”‚     Pre-trained best model (GradientBoostingClassifier) for undersampling preprocessing.
â”‚     Achieved on unseen data:
â”‚     - Accuracy: 99.46%
â”‚     - Precision: 99.99%
â”‚     - Recall: 99.33%
â”‚     - F1 Score: 99.66%
â”‚     - AUC: 99.97%
â”‚     - Sampling:	Under
â”‚     - PCA: Without PCA
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ ECU_IoHT.xlsx
â”‚       Original dataset used for training and analysis (raw logs of IoMT network transactions).
â”‚   â”œâ”€â”€ log_analysis_rest/
â”‚       Processed logs after detailed pattern analysis and reduction (~100 unique patterns identified).
â”‚       â”œâ”€â”€ info.csv
â”‚       â”œâ”€â”€ info102.csv
â”‚       â”œâ”€â”€ info486.csv
â”‚       â”œâ”€â”€ info741.csv
â”‚       â””â”€â”€ info946.csv
â”‚
â”œâ”€â”€ data_discover.ipynb
â”‚     Initial data exploration:
â”‚     - Visualizations of protocol distributions
â”‚     - Feature type analysis
â”‚     - Early insights into data quality
â”‚
â”œâ”€â”€ featuer_extraction.py
â”‚     Functions to extract key features (patterns) from raw logs.
â”‚     - Defines a reusable feature extraction pipeline.
â”‚
â”œâ”€â”€ Log_information_analysis.ipynb
â”‚     Analysis of raw logs:
â”‚     - Pattern identification
â”‚     - Log cleaning
â”‚     - Reduction of redundant information
â”‚
â”œâ”€â”€ oversampling_data_preprocessing.ipynb
â”‚     Preprocessing workflow (TCP subset):
â”‚     - Oversampling for balancing classes
â”‚     - Feature extraction + selection
â”‚     - Model training with and without PCA
â”‚     - Best Model: RandomForestClassifier
â”‚       - Accuracy: 97.16%
â”‚       - F1 Score: 95.44%
â”‚
â”œâ”€â”€ undersampling_data_preprocessing.ipynb
â”‚     Preprocessing workflow (full dataset):
â”‚     - Undersampling for class balancing
â”‚     - Feature extraction + selection
â”‚     - Model training with and without PCA
â”‚     - Best Model: GradientBoostingClassifier (saved)
â”‚
â”œâ”€â”€ utils.py
â”‚     Utility functions:
â”‚     - Data handling
â”‚     - Custom evaluation metrics
â”‚     - Visualization helpers
â”‚
â”œâ”€â”€ requirements.txt
â”‚     List of all Python dependencies.
â”‚
â””â”€â”€ README.md
      Project documentation.
```

---

## ğŸ§  Key Components

- **Feature Extraction Pipeline**:
  - Extracts meaningful patterns from complex, textual network logs.
  
- **Preprocessing Strategies**:
  - **Oversampling**: Focus on TCP protocol transactions.
  - **Undersampling**: General approach on all protocols.

- **AI Models Used**:
  - RandomForestClassifier, GradientBoostingClassifier, XGBoost, AdaBoost, DecisionTree, Gaussian Naive Bayes.

- **Model Evaluation**:
  - Precision, Recall, F1 Score, Accuracy, AUC.
  - Special attention to imbalance issues common in network security datasets.

- **Deployment Ready**:
  - Best model (`best_classifier.pkl`) is ready for integration into hospital infrastructure for real-time log security monitoring.

---

## ğŸ¤ Acknowledgements
This project was developed as part of the MDFDS Hackathon 2025, under the theme "AI for Healthcare."  
We aim to contribute toward building a safer digital environment for Moroccan healthcare systems.
